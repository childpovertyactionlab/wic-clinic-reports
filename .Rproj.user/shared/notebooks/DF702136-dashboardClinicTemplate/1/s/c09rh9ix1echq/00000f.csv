"0","summarize_role <- function(df, clinic_id, role) {"
"0","  df %>%"
"0","    filter(Site == clinic_id, Role == role) %>%"
"0","    summarize("
"0","      Vacancies = sum(Vacant == ""TRUE"", na.rm = TRUE),"
"0","      Temps = sum(`In training` == ""TRUE"" | `Temp` == ""TRUE"" | `Part-time` == ""TRUE"" | `On leave` == ""TRUE"", na.rm = TRUE),"
"0","      `WCS trainees` = sum(`WCS trainee` == ""TRUE"", na.rm = TRUE),"
"0","      Active = n() - Vacancies - Temps,"
"0","      Role = role"
"0","    )"
"0","}"
"0",""
"0","roles <- c(""clerk"", ""certifier"", ""supervisor"")"
"0","count_df <- purrr::map_dfr(roles, summarize_role, df = staff, clinic_id = clinic_id)"
"0",""
"0","create_vacancy_sentence <- function(df) {"
"0","  if (!any(df$Vacancies > 0)) {"
"0","    return(""There are no vacancies right now. Nice job!"")"
"0","  }"
"0","  "
"0","  vacancy_df <- df %>%"
"0","    filter(Vacancies > 0) %>%"
"0","    mutate("
"0","      RolePlural = ifelse(Vacancies > 1, paste0(Role, ""s""), Role),"
"0","      RoleSentence = paste(Vacancies, RolePlural, ""and"")"
"0","    ) %>%"
"0","    summarise(vacancy_sentence = stringr::str_c(RoleSentence, collapse = "" "")) %>%"
"0","    mutate(vacancy_sentence = stringr::str_remove(vacancy_sentence, "" and$""))"
"0","    "
"0","  vacancy_sentence <- stringr::str_glue(""Consider hiring {vacancy_df$vacancy_sentence} to meet staffing needs."")"
"0","  "
"0","  return(vacancy_sentence)"
"0","}"
"0",""
"0","vacancy_text <- create_vacancy_sentence(count_df)"
